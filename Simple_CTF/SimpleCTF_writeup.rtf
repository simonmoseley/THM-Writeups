{\rtf1\ansi\ansicpg1252\cocoartf2580
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\margl1440\margr1440\vieww21820\viewh15580\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs26 \cf0 TryHackMe - Simple CTF Writeup\
\
This lab is a simple, beginner level CTF with plain and simple instructions. \
Deploy the machine and attempt the questions!\
\
1. How many services are running under port 1000?\
2. What is running on the higher port?\
3. What\'92s the CVE you\'92re using against the application?\
4. To what kind of vulnerability is the application vulnerability?\
5. What is the password?\
6. Where can you login with the details obtained?\
7. What\'92s the user flag?\
8. Is there any other user in the home directory? What\'92s its name?\
9. What can you leverage to spawn a privileged shell?\
10. What\'92s the root flag?\
\
ENUMERATION:\
\
I begin by running Nmap on the IP address we are given to see what ports are open. I also send the output to an initial_scan file. \
\
\{nmap1 photo\}\
\
The results of the scan show 3 open ports. 21, 80 and 2222. With this I can answer question 1.\
I now run nmap again with the -A flag, on those 3 ports to see what additional info we can find. \
\
\{nmap2 photo\}\
\
Ok, lots of good info here. From the top I can see the FTP service on port 21 allows anonymous logins, there is an Apache web server running on port 80 with a robots.txt file, and The SSH service is running on port 2222. With this we can answer question 2.\
\
Now I enter the IP address into my browser to see what\'92s there. Its an Apache2 Default page. \
\
\{browser1 photo\}\
\
Remembering the scan results I visit the robots.txt file and find what looks like a note from the Content Management System, explaining what the Robots.txt is used for. I\'92ll add CUPS to me notes as the possible CMS.\
\
\{robots photo\}\
\
Next I use gobuster to see what hidden directories, files or redirects I can find. \
\
\{gobuster1 photo\}\
\
In our gobuster results there is a directory called /simple. \
 \
\{gobuster2 photo\}\
\
Navigating to it we find the CMS Made Simple CMS. \
\
\{browser2 photo\}\
\
Since there\'92s a CMS here, there must be a login portal somewhere. I run gobuster again against the new directory to see what else I can find. \
\
\{gobuster3 photo\}\
\
In the results I find a /admin directory, navigating to it I find a login portal\
\
\{browser3 photo\}\
\
After trying a few times at the login portal. I decided to try a different route. I stop with the web portion here and go to see what I can find with FTP by using the anonymous login. \
After logging I find a directory called pub.\
\
\{ftp1 photo\}\
\
In it I find a txt file called ForMitch. Lets GET it and see what it says. \
\
\{ftp2 photo\}\
\{ftp3 photo\}\
\
In the file we get a message for Mitch with a huge hint. \
\
\{Mitch photo\}\
\
So now we have a possible username and that it is a weak password. \
\
My first thought is to use hydra to try and bruteforce SSH using Mitch as the username.\
SUCCESS!\
\
\{hydra1 photo\}\
\
So from here we can answer questions 4 and 5. But we skipped 2 and 3 so lets I go back\
\
\
Going back to the the Simple CMS, I see at the bottom of the page that the version is 2.2.8 \
\
\{cms1 photo\}\
\
I use searchsploit to see if there are any known vulnerabilities and find exploit 46635.py. Looking at it shows the answers for questions 3 and 4. \
\
\{exploit1\}\
\{exploit2\}\
\
Getting back on track, I use the credentials we found to login through ssh. \
\
\{ssh1 photo\}\
\
In Mitch\'92s home folder we find the user.txt file that contains the user flag and the answer to question 7. \
\
\{userFlag photo\}\
\
Question 8 asks if there are other users. I move up one level and list the contents. \
\
\{ssh2 photo\}\
\
Running sudo -l shows Mitch can run /usr/bin/vim as root. Also the answer to question 9.\
\
\{ssh3 photo\}\
\
Finally, I use vim to escalate my privileges to root. Run the command sudo /usr/bin/vim. From there spawn the root shell by typing :!sh.  Afterwards type whoami to verify you are root. \
\
Pe1 \
Pe2\
Pe3\
\
Now as root we can navigate to the root folder, cat our root flag and answer the final question. \
\
\
\
\
\
\
}